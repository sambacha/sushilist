"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@ethersproject/address"),r=t(require("lodash/compact")),n=t(require("lodash/filter")),o=t(require("lodash/find")),i=t(require("lodash/keyBy")),a=t(require("lodash/matchesProperty")),s=t(require("lodash/merge")),c=t(require("lodash/pick")),u=t(require("lodash/some")),l=t(require("lodash/uniq")),p=require("path"),f=require("os"),h=require("zod"),d=require("fs"),m=t(require("lodash/partition")),v=t(require("degit")),y=t(require("lodash/isPlainObject")),g=t(require("lodash/isString")),w=t(require("lodash/mapValues")),b=t(require("mkdirp")),k=t(require("lodash/mapKeys")),x=t(require("lodash/isEmpty")),j=t(require("get-svg-colors")),O=t(require("lodash/unionBy")),E=t(require("node-fetch"));function _(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function L(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){_(i,n,o,a,s,"next",t)}function s(t){_(i,n,o,a,s,"throw",t)}a(void 0)}))}}function T(){return(T=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function S(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)e.indexOf(r=i[n])>=0||(o[r]=t[r]);return o}var q,P=(function(t){var e=function(t){var e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o=Object.create((e&&e.prototype instanceof p?e:p).prototype),i=new j(n||[]);return o._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===l)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(t,r,i),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function p(){}function f(){}function h(){}var d={};d[o]=function(){return this};var m=Object.getPrototypeOf,v=m&&m(m(O([])));v&&v!==e&&r.call(v,o)&&(d=v);var y=h.prototype=p.prototype=Object.create(d);function g(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){var n;this._invoke=function(o,i){function a(){return new e((function(n,a){!function n(o,i,a,s){var c=u(t[o],t,i);if("throw"!==c.type){var l=c.arg,p=l.value;return p&&"object"==typeof p&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(p).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}(o,i,n,a)}))}return n=n?n.then(a,a):a()}}function b(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=u(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function O(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=y.constructor=h,h.constructor=f,f.displayName=s(h,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},g(w.prototype),w.prototype[i]=function(){return this},t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(y),s(y,a,"Generator"),y[o]=function(){return this},y.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=O,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}(q={exports:{}}),q.exports),C=p.resolve(f.tmpdir(),"contract-metadata"),A=p.resolve(f.tmpdir(),"ethereum-lists/tokens"),N=h.string().url().nonempty(),F=h.record(N),I={coingecko:"https://tokens.coingecko.com/uniswap/all.json"},R=h.enum(["coingecko"]),U=h.object({blog:h.string().optional(),chat:h.string().optional(),discord:h.string().optional(),facebook:h.string().optional(),forum:h.string().optional(),github:h.string().optional(),gitter:h.string().optional(),instagram:h.string().optional(),linkedin:h.string().optional(),medium:h.string().optional(),reddit:h.string().optional(),slack:h.string().optional(),telegram:h.string().optional(),twitter:h.string().optional(),youtube:h.string().optional()}),G=h.object({new_address:h.string().optional()}),M=h.object({color:h.string().optional(),isChefCurated:h.boolean().optional(),isVerified:h.boolean().optional(),shadowColor:h.string().optional()}),H=h.object({address:h.string().regex(/^0x[a-fA-F0-9]{40}$/),chainId:h.number().optional(),decimals:h.number().min(0),deprecation:G.optional(),extensions:M.optional(),name:h.string(),social:U.optional(),symbol:h.string(),website:h.string().optional()}),B=h.object({address:h.string(),decimals:h.union([h.string(),h.number()]),name:h.string(),symbol:h.string()}),D=h.object({address:h.string().optional(),decimals:h.union([h.string(),h.number()]).optional(),deprecation:G.optional(),name:h.string().optional(),social:U.optional(),symbol:h.string().optional(),website:h.string().optional()}),J={__proto__:null,CONTRACT_MAP_REPO:"metamask/contract-metadata",CONTRACT_MAP_OUTPUT_PATH:C,ETHEREUM_LISTS_REPO:"ethereum-lists/tokens/tokens/eth",ETHEREUM_LISTS_OUTPUT_PATH:A,TokenListItemSchema:N,TokenListTypeSchema:F,TOKEN_LISTS:I,TokenListEnumSchema:R,SocialSchema:U,TokenDeprecationSchema:G,TokenExtensionsSchema:M,TokenSchema:H,RawContractMapTokenSchema:B,RawEthereumListsTokenSchema:D},V=function(){var t=L(P.mark((function t(e,r){return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){return v(e,{cache:!1,force:!0}).clone(r).then(t).catch((function(t){throw n(),new Error("Failed to fetch repo "+e+": "+(t.message||t))}))})));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),K=function(){var t=L(P.mark((function t(e){return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.promises.readFile(e,"utf8");case 3:return t.abrupt("return",JSON.parse(t.sent));case 7:throw t.prev=7,t.t0=t.catch(0),new Error("Failed to parse file "+e+": "+t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),Y=function(t){var e=T({},c(t,Object.keys(D.shape)),{deprecation:c(t.deprecation,Object.keys(G.shape)),social:c(t.social,Object.keys(U.shape))});return T({},H.parse(e),{social:U.parse(e.social)})},z=function(t){return t.sort((function(t,e){return t.symbol.localeCompare(e.symbol)}))},Z=function(){var t=L(P.mark((function t(e){return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.promises.access(e);case 3:t.next=10;break;case 5:if(t.prev=5,t.t0=t.catch(0),"ENOENT"===t.t0.code){t.next=9;break}throw new Error("Failed to create output folder: "+t.t0.message);case 9:b.sync(e);case 10:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}(),$=function(t){return function t(e,r){return y(e)?w(e,(function(e){return t(e,r)})):r(e)}(t,(function(t){return g(t)?t.trim():t}))},Q=function(){var t=L(P.mark((function t(e,r,n){var o;return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z(r);case 2:return o=JSON.stringify(e,null,2),t.abrupt("return",d.promises.writeFile(p.resolve(r,n),o,"utf8"));case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),W=function(t){var e=m(t,(function(e){return 1===n(t,["symbol",e.symbol]).length}));return[e[0],e[1]]};function X(t){return t.map((function(e){var r=e.deprecation,n=S(e,["deprecation"]);return null!=r&&r.new_address&&t.find(a("address",r.new_address))||n}))}function tt(){return et.apply(this,arguments)}function et(){return(et=L(P.mark((function t(){return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.promises.readdir(A);case 2:return t.abrupt("return",t.sent.reduce(function(){var t=L(P.mark((function t(e,r){var n,o;return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=p.resolve(A,r),t.next=3,K(n);case 3:return o=Y(t.sent),t.t0=Promise,t.t1=[],t.next=9,e;case 9:return t.t2=t.sent,t.t3=[o],t.t4=t.t1.concat.call(t.t1,t.t2,t.t3),t.abrupt("return",t.t0.resolve.call(t.t0,t.t4));case 13:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),Promise.resolve([])));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function rt(){return nt.apply(this,arguments)}function nt(){return(nt=L(P.mark((function t(){return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V("ethereum-lists/tokens/tokens/eth",A);case 2:return t.abrupt("return",tt().then(X).then(W));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ot(){return it.apply(this,arguments)}function it(){return(it=L(P.mark((function t(){var r;return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=p.resolve(process.cwd(),"chef.json"),t.abrupt("return",K(r).then((function(t){return k(t,(function(){return"ETH"===(arguments.length<=1?void 0:arguments[1])?arguments.length<=1?void 0:arguments[1]:e.getAddress(arguments.length<=1?void 0:arguments[1])}))})));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function at(){return st.apply(this,arguments)}function st(){return(st=L(P.mark((function t(){var e,r;return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V("metamask/contract-metadata",C);case 2:return e=p.resolve(C,"contract-map.json"),t.next=5,K(e);case 5:return r=t.sent,t.abrupt("return",Object.keys(r).map((function(t){return T({},r[t],{address:t})})).map((function(t){return c(t,Object.keys(B.shape))})).filter((function(t){return Object.values(t).some(x)})).map(Y));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ct=p.resolve(f.tmpdir(),"spothq/cryptocurrency-icons"),ut="mikedemarais/react-coin-icon/assets/overrides",lt=p.resolve(f.tmpdir(),ut);function pt(){return ft.apply(this,arguments)}function ft(){return(ft=L(P.mark((function t(){var e;return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V("spothq/cryptocurrency-icons",ct);case 2:return e=p.resolve(ct,"manifest.json"),t.abrupt("return",K(e));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ht(){return dt.apply(this,arguments)}function dt(){return(dt=L(P.mark((function t(){return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V(ut,lt);case 2:return t.next=4,d.promises.readdir(lt);case 4:return t.abrupt("return",t.sent.reduce(function(){var t=L(P.mark((function t(e,n){var o,i,a;return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=p.resolve(lt,n),t.next=3,d.promises.readFile(o,"utf8");case 3:return i=j(t.sent).fills[0],a=void 0,i?a={symbol:n.split(".")[0].toUpperCase()}:console.error("Unable to adjust Chef's derived colorsfrom the: `"+n+"`"),t.t0=Promise,t.t1=r,t.t2=[],t.next=12,e;case 12:return t.t3=t.sent,t.t4=[a],t.t5=t.t2.concat.call(t.t2,t.t3,t.t4),t.t6=(0,t.t1)(t.t5),t.abrupt("return",t.t0.resolve.call(t.t0,t.t6));case 17:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),Promise.resolve([])));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mt(){return vt.apply(this,arguments)}function vt(){return(vt=L(P.mark((function t(){var e;return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pt();case 2:return e=t.sent,t.next=5,ht();case 5:return t.abrupt("return",O(e,t.sent,"symbol"));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yt(t){return t.reduce((function(t,e){return Object.assign(e,t)}),{})}function gt(){return wt.apply(this,arguments)}function wt(){return(wt=L(P.mark((function t(){return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(R.options.map(function(){var t=L(P.mark((function t(e){return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=L(P.mark((function t(r,n){return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",E(I[e]).then((function(t){return t.json()})).then((function(t){var n;return r(((n={})[e]={tags:t.tags,tokens:t.tokens},n))})).catch(n));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:return t.abrupt("return",yt(t.sent.map((function(t){return T({},t)}))));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function bt(t){return i(t,(function(t){return e.getAddress(t.address)}))}process.env.NODE_TLS_REJECT_UNAUTHORIZED="1",console.log(" 🍣 rolling up the token list "),L(P.mark((function t(){var i,f,h,d,m,v,y,g,w,b,k,x,j,O,E;return P.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return O=function(){return x.map((function(t){var e=j(t),n=m[t],o=e.chainId,i=void 0===o?1:o,a=e.color,s=e.decimals,c=e.name,u=e.shadowColor,l=e.symbol,p=b.preferred.map(Object.keys).flat().includes(t);if(p){var f=v.find((function(t){return t.symbol===l}));a=null==f?void 0:f.color}var h={color:(null==n?void 0:n.color)||a,isChefCurated:!(null==n||!n.isCurated)||void 0,isVerified:!!(p||null!=n&&n.isCurated)||void 0,shadowColor:(null==n?void 0:n.shadowColor)||u};return $(T({address:t,chainId:i,decimals:s,name:(null==n?void 0:n.name)||c,symbol:(null==n?void 0:n.symbol)||l},r(Object.values(h)).length?{extensions:h}:void 0))}))},j=function(t){function r(r){return e.getAddress(r.address)===e.getAddress(t)}var n=c(y,Object.keys(y).filter((function(t){return u(y[t].tokens,r)})));return 1===Object.keys(n).length?o(n[Object.keys(n)[0]].tokens,r):Object.keys(n).length>1&&Object.keys(n).includes(R.enum.coingecko)?o(n.coingecko.tokens,r):k[t]},t.next=4,at();case 4:return i=t.sent,t.next=7,rt();case 7:return h=(f=t.sent)[0],d=f[1],t.next=12,ot();case 12:return m=t.sent,t.next=15,mt();case 15:return v=t.sent,t.next=18,gt();case 18:return g=(y=t.sent).coingecko,w=S(y,["coingecko"]),b={default:[d,h,i,g.tokens.flat()].map(bt),preferred:[Object.values(w).map((function(t){return t.tokens})).flat()].map(bt)},k=s.apply(void 0,[{}].concat(b.default)),x=l(r([].concat(b.default.map(Object.keys).flat(),b.preferred.map(Object.keys).flat())).map(e.getAddress)),t.next=25,z(O());case 25:return E=t.sent,t.next=28,Q({name:"SushiSwap Menu List",timestamp:(new Date).toISOString(),logoURI:"https://avatars.githubusercontent.com/u/72222929?s=200&v=4",version:{major:1,minor:2,patch:1},keywords:["sushiswap"],tokens:E},p.resolve(process.cwd(),"./output"),"sushiswap-token-list.json");case 28:console.log('# of "isCuratedActive" tokens: ',n(E,a("extensions.isCuratedActive",!0)).length),console.log('# of "isSushiBar" tokens: ',n(E,a("extensions.isSushiBar",!0)).length);case 30:case"end":return t.stop()}}),t)})))(),exports.Types=J;
//# sourceMappingURL=sushiswap-token-list.cjs.production.min.js.map
